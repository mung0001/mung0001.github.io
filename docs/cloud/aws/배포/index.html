<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="배포 ( Deploy )    배포 ( Deploy )  무중단 배포  서비스를 배포시 ( 버전 업데이트 등 ) 서버를 중단하지 않고 배포( 업데이트 )를 진행하는 것   중단배포( Ice breaking )  서비스를 배포시 서버를 중단하고 배포를 진행하는 것 ( 서버 정기 정검 )   In-Place Deployment  In-Place Deployment... In-Place Deployment    한 개의 로드밸런서가 4개의 서버로 요청을 보내고 있으며, 현재 1."><meta property="og:title" content="" />
<meta property="og:description" content="배포 ( Deploy )    배포 ( Deploy )  무중단 배포  서비스를 배포시 ( 버전 업데이트 등 ) 서버를 중단하지 않고 배포( 업데이트 )를 진행하는 것   중단배포( Ice breaking )  서비스를 배포시 서버를 중단하고 배포를 진행하는 것 ( 서버 정기 정검 )   In-Place Deployment  In-Place Deployment... In-Place Deployment    한 개의 로드밸런서가 4개의 서버로 요청을 보내고 있으며, 현재 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mung0001.github.io/docs/cloud/aws/%EB%B0%B0%ED%8F%AC/" />


<title>왈왈왈</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.63eb88daa545365405ecdbb21033286a325c60a36cfa6d22d21e7c3bc9286941.css" integrity="sha256-Y&#43;uI2qVFNlQF7NuyEDMoajJcYKNs&#43;m0i0h58O8koaUE=">
<script defer src="/en.search.min.d378dbb63a65445c5566a5825ea5ba60980a87774a4a07a164396cded5f52349.js" integrity="sha256-03jbtjplRFxVZqWCXqW6YJgKh3dKSgehZDls3tX1I0k="></script>
<!--

-->

  
</head>

<body>
  <div class="background">
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex" style="max-width:95%;" >
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/"><span>왈왈왈</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  

  
  





 
  
    




  
  <ul>
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/cloud/" class="">AWS</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/cloud/aws/" class="collapsed ">A W S</a>
  


    




  
  <ul>
    
      
        <li>

  
  <a href="/docs/cloud/aws/aws_computing/" class="">A W S Computing</a>
  

</li>
      
    
      
    
      
    
      
    
      
    
      
        <li>

  
  <a href="/docs/cloud/aws/auto-scaling/" class="">Auto Scaling</a>
  

</li>
      
    
      
        <li>

  
  <a href="/docs/cloud/aws/aws-%EA%B3%84%EC%A0%95/" class="">A W S 계정</a>
  

</li>
      
    
      
    
      
    
      
    
      
    
      
        <li>

  
  <a href="/docs/cloud/aws/aws%EC%9A%94%EA%B8%88/" class="">A W S요금</a>
  

</li>
      
    
      
        <li>

  
  <a href="/docs/cloud/aws/vpc/" class="">V P C</a>
  

</li>
      
    
      
        <li>

  
  <a href="/docs/cloud/aws/%EB%B0%B0%ED%8F%AC/" class="active">배포</a>
  

</li>
      
    
      
        <li>

  
  <a href="/docs/cloud/aws/%EC%96%91%EC%8B%9D/" class="">양식</a>
  

</li>
      
    
      
        <li>

  
  <a href="/docs/cloud/aws/%EC%9A%B4%EC%98%81-%EC%84%9C%EB%B2%84%EC%9D%98-%EC%99%B8%EB%B6%80%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1/" class="">운영 서버의 외부환경 구성</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/programing/" class="">Programing</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/programing/code/" class="collapsed ">Code</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/study/" class="">Study</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/study/django/" class="collapsed ">Django</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/golang/" class="collapsed ">Golang</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/network/" class="collapsed ">Network</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/openstack/" class="collapsed ">Open Stack</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/security/" class="collapsed ">Security</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/system/" class="collapsed ">System</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/web/" class="collapsed ">Web</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/%EC%A0%84%EC%A0%84/" class="collapsed ">전전</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/study/%EC%A0%95%EB%B3%B4%EC%B2%98%EB%A6%AC%EA%B8%B0%EC%82%AC/" class="collapsed ">정보처리기사</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Project</span>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/project/mini/" class="collapsed ">M Ini</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
  </ul>
  



  














  
<ul>
  
  <li>
    <a href="/posts/" >
        Blog
      </a>
  </li>
  
</ul>







</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>배포</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#배포--deploy--1"><strong>배포 ( Deploy )</strong></a></li>
  </ul>

  <ul>
    <li><a href="#무중단-배포"><strong>무중단 배포</strong></a></li>
  </ul>

  <ul>
    <li><a href="#중단배포-ice-breaking-"><strong>중단배포( Ice breaking )</strong></a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#in-place-deployment"><strong>In-Place Deployment</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#blue-green-deployment"><strong>Blue-Green Deployment</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#iam--identity-and-access-management-"><strong>IAM ( Identity and Access Management )</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#정책--policy-"><strong>정책 ( Policy )</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#역할--role-"><strong>역할 ( Role )</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#그룹-사용자"><strong>그룹&amp; 사용자</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#codedeploy"><strong>CodeDeploy</strong></a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#codedeploy-구성요소"><strong>CodeDeploy 구성요소</strong></a></li>
      </ul>
    </li>
  </ul>
</nav>


    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="배포--deploy-"><strong>배포 ( Deploy )</strong></h1>
<hr>
<h1 id="heading"></h1>
<p> </p>
<h2 id="배포--deploy--1"><strong>배포 ( Deploy )</strong></h2>
<h1 id="heading-1"></h1>
<h2 id="무중단-배포"><strong>무중단 배포</strong></h2>
<ul>
<li>서비스를 배포시 ( 버전 업데이트 등 ) 서버를 중단하지 않고 배포( 업데이트 )를 진행하는 것</li>
</ul>
<h1 id="heading-2"></h1>
<h2 id="중단배포-ice-breaking-"><strong>중단배포( Ice breaking )</strong></h2>
<ul>
<li>서비스를 배포시 서버를 중단하고 배포를 진행하는 것 ( 서버 정기 정검 )</li>
</ul>
<h1 id="heading-3"></h1>
<h3 id="in-place-deployment"><strong>In-Place Deployment</strong></h3>
<blockquote>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>In-Place Deployment</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <h1 id="heading"></h1>
<h2 id="in-place-deployment"><strong>In-Place Deployment</strong></h2>
<hr>
<h1 id="heading-1"></h1>
<p><img src="/Deploy/IPD.png" alt="IPD"></p>
<ul>
<li>한 개의 로드밸런서가 4개의 서버로 요청을 보내고 있으며, 현재 1.0.1의 버전을 사용하고 있다. 만약 여기서 1.0.2로 버전을 업데이트 하는 경우</li>
</ul>
<h1 id="heading-2"></h1>
<ol>
<li><strong>로드밸런서와 Server 1, Server 2의 연결을 해제한다. 로드밸런서는 Server 3와 Server 4로만 요청을 보내게 된다.</strong>
<img src="/Deploy/IPD2.png" alt="IPD"></li>
</ol>
<h1 id="heading-3"></h1>
<ol start="2">
<li><strong>나머지 Server 두개를 버전 1.0.2로 업데이트 한다.</strong>
<img src="/Deploy/IPD3.png" alt="IPD"></li>
</ol>
<h1 id="heading-4"></h1>
<ol start="3">
<li><strong>업데이트한 서버를 로드밸런서에 연결한다.</strong>
<img src="/Deploy/IPD4.png" alt="IPD"></li>
</ol>
<h1 id="heading-5"></h1>
<ol start="4">
<li><strong>앞의 과정을 반복한다.</strong>
<img src="/Deploy/IPD5.png" alt="IPD">
<img src="/Deploy/IPD6.png" alt="IPD"></li>
</ol>
<h1 id="heading-6"></h1>
<ul>
<li>IN-Place Deployment는 현재 사용 가능한 자원을 그대로 사용하여 무중단 배포를 할 수 있다는 장점이 있다.</li>
<li>하지만 본래 4개의 서버가 2개만 돌아가는 만큼 가용서버가 적어져 부하가 걸릴 수 밖에 없다.</li>
<li>만약 롤백을 해야하는 경우 시간적인 소모가 길어 작업에 차질이 생길 수 있다.</li>
</ul>
    </div>
  </label>
</div>

</blockquote>
<h1 id="heading-4"></h1>
<h3 id="blue-green-deployment"><strong>Blue-Green Deployment</strong></h3>
<blockquote>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Blue-Green Deployment</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <h1 id="heading"></h1>
<p>Blue-Green Deployment</p>
<hr>
<h1 id="heading-1"></h1>
<p><img src="/Deploy/BGD.png" alt="BGD"></p>
<ul>
<li>블루/ 그린 배포의 원리도 간단하다. 블루/ 그랜 배포는 현재 무중단의 기본 원칙인 구버전과 신버전이 동시에 떠 있어도 아무런 문제가 없어야 한다는 것이지만, 두 버전이 동시에 떠 있어서 발생하는 예쌍치 못한 장애의 위험을 더 줄일 수 있다.</li>
<li>현재위치 배포의 단점을 어느 정도 보완할 수 있는 방법으로, 현재위치 배포에서 했던 것과 비슷하지만 이번에는 4개의 서버가 하나의 그룹에 들어가 있다는 전제로 설명해보겠다.</li>
</ul>
<h1 id="heading-2"></h1>
<ol>
<li><strong>기존의 서버그룹과 같은 서버그룹을 복제한다.</strong>
<img src="/Deploy/BGD2.png" alt="BGD"></li>
</ol>
<h1 id="heading-3"></h1>
<ol start="2">
<li><strong>복사한 서버그룹 내부의 서버들에 업데이트를 진행한다.</strong>
<img src="/Deploy/BGD3.png" alt="BGD"></li>
</ol>
<h1 id="heading-4"></h1>
<ol start="3">
<li><strong>업데이트가 진행된 복사한 서버그룹을 로드밸런서에 연결한다.</strong>
<img src="/Deploy/BGD4.png" alt="BGD"></li>
</ol>
<h1 id="heading-5"></h1>
<ol start="4">
<li><strong>업데이트가 진행된 복사한 서버그룹을 로드밸런서에 연결한다.</strong>
<img src="/Deploy/BGD5.png" alt="BGD"></li>
</ol>
<h1 id="heading-6"></h1>
<ul>
<li>이러한 과정을 거치면 온전하게 서버를 이용할 수 있으며, 서버 또한 제대로 업데이트 되어진 장점이 있다.</li>
<li>하지만 만약 서버가 클라우드나 가상환경이 아닌, 물리적인 서버일 경우, 기존의 서버를 그대로 복사하는 것을 사실상 불가능하며, 비 효율적일 수 밖에 없어 함부로 선택할 수 없다.</li>
</ul>
<h1 id="heading-7"></h1>
<h3 id="서버-내-blue-green-deployments"><strong>서버 내 Blue/ Green Deployments</strong></h3>
<!-- raw HTML omitted -->

    </div>
  </label>
</div>

</blockquote>
<h1 id="heading-5"></h1>
<p> </p>
<h1 id="heading-6"></h1>
<p> </p>
<h1 id="aws-iam"><strong>AWS IAM</strong></h1>
<hr>
<h1 id="heading-7"></h1>
<h3 id="iam--identity-and-access-management-"><strong>IAM ( Identity and Access Management )</strong></h3>
<p><img src="/IAM/IAM.png" alt="IAM" /></p>
<ul>
<li>AWS 리소스에 대한 엑세스를 안전하게 제어할 수 있는 서비스로 IAM을 사용하여 리소스를 사용하도록 권한을 부여하거나 인증된 대상을 제어</li>
<li>주요기능
<ul>
<li>AWS 계정에 대한 공유 엑세스</li>
<li>서비스별 세분화된 권한 제공 가능</li>
<li>EC2에서 실행되는 앱을 위한 AWS 리소스 엑세스 권한 제공</li>
<li>멀티 팩터 인즌 ( MFA )</li>
<li>자격 증명 연동</li>
</ul>
</li>
<li>AWS 서비스들은 IAM Role을 할당받아 권한을 부여받을 수 있음</li>
<li>Access Key와 Secret Access Key를 직접 입력하지 않고 권한 부여 가능</li>
<li>IAM 사용자 계정을 만들어 사용자에게 적절한 궎나을 부여하고 사용 가능한 서비스를 제한할 수 있음</li>
</ul>
<h1 id="heading-8"></h1>
<h3 id="정책--policy-"><strong>정책 ( Policy )</strong></h3>
<ul>
<li>User, Group, Role이 사용할 수 있는 권한의 범위를 지정하는 것</li>
<li>S3FullAccess, Administrator Access 등 다양한 엑세스 권한이 이미 정의되어 있으며 이를 ‘AWS 관리형 이라 함</li>
<li>사용자 정의 정책 생성
<ul>
<li>JSON 형식 또는 직접 선택을 통해 사용자 정의 정책 선택 가능</li>
</ul>
</li>
</ul>
<h1 id="heading-9"></h1>
<h3 id="역할--role-"><strong>역할 ( Role )</strong></h3>
<ul>
<li>특정 권한을 가진 계정에 생성할 수 있는 IAM 자격증명</li>
<li>역할에는 다음과 같은 주체가 있음
<ul>
<li>AWS 계정의 IAM 사용자</li>
<li>AWS의 서비스 ( EC2, RDS, ELB 등 )</li>
<li>외부 자격 증명 공급자 서비스에 의해 인증된 외부 사용자</li>
</ul>
</li>
<li>역할 생성시 IAM 사용자, 서비스, 외부 사용자 등 주체를 정해야 함</li>
<li>하나의 역할에는 다수의 정책을 연결할 수 있음</li>
<li>생성된 역할을 서비스 혹은 IAM 사용자 등에 연결</li>
<li>Region에 국한되지 않고 사용 가능</li>
<li>신규 유저는 생성시 아무런 권한이 없으며 Access Key와 Secret Access Key가 할당</li>
<li>각 키는 최초 생성시에만 볼 수 있으며 즉시 보관해야 함</li>
</ul>
<h1 id="heading-10"></h1>
<h3 id="그룹-사용자"><strong>그룹&amp; 사용자</strong></h3>
<ul>
<li>사용자는 IAM 사용자를 의미하여 관리자 계정에 의해 부여받은 권한에 한해 제한된 서비스에 접근할 수 있는 계정을 의미</li>
<li>콘솔 로그인과 프로그래밍 엑세스 가능 여부를 선택하여 생성 가능</li>
<li>콘솔 로그인이 승인된 경우, 별도의 링크를 통해 콘솔에 로그인 할 수 있음</li>
<li>각 사용자마다 정책을 부여할 수 있음</li>
<li>사용자 모두에게 일일이 부여하기 힘들거나 그룹단위로 통제하고 싶은 경우, Group을 사용할 수 있음</li>
<li>그룹은 이미 생성된 사용자와 권한을 설정할 수 있으며, 그룹 내 모든 사용자는 그룹의 권한을 적용받음</li>
</ul>
<h1 id="heading-11"></h1>
<table>
<thead>
<tr>
<th>이름</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr>
<td>권한</td>
<td>AWS의 서비스나 자원에 어떤 작업을 할 수 있는지 명시해두는 규칙, 예를 들어, &quot; 서울 리전에 있는 모든 EC2를 조회할 수 있다&rdquo; 와 같은 항목이 하나의 권한을 칭한다.</td>
</tr>
<tr>
<td>정책</td>
<td>권한들의 모음으로, 사용자나 권한들에 직접 적용은 불가능하며, 권한들로 만든 정책을 적용해야 한다. 정책은 사용자, 그룹, 역할에 적용할 수 있다.</td>
</tr>
<tr>
<td>사용자</td>
<td>사용자는 AWS의 기능과 자원을 이용하는 객체, 사용자별로 어떤 권한을 가졌는지 세분화해서 지정할 수 있으며, 사용자는 AWS Console에 접근할 수 있는 사람일 수도 있고, 자동화되어 실행되는 프로그램일 수도 있다. 접속하는 사용자인 경우에는 비밀번화가 제공되지만, 프로그램인 경우에는 액세스 키 ID와 비밀 엑세스 키가 제공된다.</td>
</tr>
<tr>
<td>그룹</td>
<td>여러 사용자에게 공통으로 권한을 부여할 수 있게 만들어진 개념이다. 하나의 그룹에 여러 명의 사용자를 지정이 가능</td>
</tr>
<tr>
<td>역할</td>
<td>어떤 행위를 하는 객체에 여러 정책을 적용한다는 점에서 사용자와 비슷ㅎ자ㅣ만 객체가 사용자가 아닌 서비스나 다른 AWS 계정의 사용자라는 점에서 차이가 있다. 사용자가 아닌 특정 서비스에서 생성한 객체에 권한을 부여하는 데 사용</td>
</tr>
<tr>
<td>인스턴스 프로파일</td>
<td>사용자가 사람을 구분하고 그 사람에 권한을 주기 위한 개념이었따면, 인스턴스 프로파일은 EC2 인스턴스를 구분하고 그 인스턴스에 권한을 주기 위한 개념</td>
</tr>
</tbody>
</table>
<div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Expand</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <h1 id="heading"></h1>
<h2 id="heading-1">****</h2>
<hr>
<h1 id="heading-2"></h1>
    </div>
  </label>
</div>

<h1 id="heading-12"></h1>
<p> </p>
<h1 id="aws-codedeploy"><strong>AWS CodeDeploy</strong></h1>
<hr>
<h1 id="heading-13"></h1>
<h2 id="codedeploy"><strong>CodeDeploy</strong></h2>
<p><img src="/CodeDeploy/CodeDeploy.png" alt="CD" /></p>
<h1 id="heading-14"></h1>
<ul>
<li>AWS에서 제공하는 배포 자동화 서비스</li>
<li>EC2 인스턴스들에 코드를 배포하는 과정을 자동으로 진행시켜 줌</li>
<li>카피스트라노 ( Capistrano )나 젠킨스 ( Jenkins ) 같은 서드파티 배포 자동화도구 보다 AWS 내 다양한 서비스와 손쉽게 연동이 가능하다.</li>
<li>CodeDeploy는 무중단 배포 기법들인 IDP/ BGD를 둘다 지원한다.</li>
<li>CodeDeploy란 단순히 명령어를 적어두고 프로그램이 그 명령을 순차적으로 실행하는 것 뿐이다.</li>
<li>단순히 우리가 해주는 일을 대신 해주는 Auto Scaling과 같은 개념</li>
<li>CodeDeploy로 배포하고자 한다면 EC2 인스턴스에 반드시 설치되어 있어야 하며 *.yml파일에 있는 절차를 따라서 배포를 진행한다.
 </li>
</ul>
<h3 id="codedeploy-구성요소"><strong>CodeDeploy 구성요소</strong></h3>
<h1 id="heading-15"></h1>
<ul>
<li>AppSpec.yml</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-tpl" data-lang="tpl">vesion: 0.0

os: linux
# 윈도우, 리눅스 등 어떤 OS를 위한 배포 파일인지를 명시한다.

# CodeDeploy Agent는 배포 명령을 받으면 코드 저장소에 있는 프로젝트 전체를 서버의 임시 결로로 내려 받는다.
# 내려받은 프로젝트를 서버 내 어느 경로로 이동시킬지 명시할 수 있다.

files:
    - source: /
      destination: /var/www
# AppSpec.yml에서는 배포 시 발생하는 다양한 생명주기마다 원하는 스크립트를 실행할 수 있게 후크를 제공해준다.
# 배포 시 사용하는 스크립트들은 훤하는 곳에 둬도 되며, 보통은 프로젝트에 AppSpec.yml 파일을 포함하듯이 함께 포함한다.
# 이 예시에서는 프로젝트 최상단에 scripts라는 디렉터리를 만들어 그 안에 스크립트들을 보관해 둔다.

hooks:
    # 코드 저장소에서 프로젝트를 낼받은 뒤 인스턴스 내 배포를 원하느 경로에 파일들을 옮기기 전이며, 예시에서 사용한 스크립트의 이름을 보면 리소스 데이터 번들을 압축 해제하는 것으로 추축할 수 있다.
    BeforeInstall:
        - location: scripts/UnzipResourceBundle.sh
        - location: scripts/UnzipDataBundle.sh
    # 파일을 모두 이동한 후 실행되는 스크립트들이다.
    # 파일 이름을 봐서 리소스 파일들이 제대로 존재하는 지 테스트하는 것으로 추측할 수 있다.
    # 또한 Timeout 옵션을 두어 180초 이내에 스크립트가 완료되지 않으면 배포에 실패한 것으로 간주한다.

AfterInstall:
    - location: scripts/RunResourceTests.sh
    timeout: 180
    # 애플리케이션을 시작할 때 사용하는 스크립트들이다.
    # 예시에서는 서버를 재시작하고 최대 240초 동안 기다리는 것을 알 수 있다.

ApplicationStart:
    - location: scripts/RestartServer.sh
    timeout: 240
    # 서비스를 재시작한 후 실제로 서비스가 올바르게 실행됐는 지 확인 할 때 사용한느 스크립트들이다.
    # runas 옵션을 주어 기본 사용자인 ec2-user가 아닌 codedeployuser라는 다른 user로 실행하게 했다.

ValidateService:
    - location: scripts/ValidateService.sh
    timeout: 30
    runas: codedeployuser
</code></pre></div><h1 id="heading-16"></h1>
<ul>
<li>스크립트 파일들에 실행 권항을 추가해서 Git에 올리고 싶다면 다음과 같은 명령어를 이용하면 된다.</li>
</ul>
<pre><code class="language-tql" data-lang="tql">git update-index --chmod=+x &lt;스크립트 파일 이름&gt;
</code></pre><blockquote>
<p><div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>CodeDeploy 작동절차</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <h1 id="heading"></h1>
<h2 id="codedeploy-작동절차"><strong>CodeDeploy 작동절차</strong></h2>
<hr>
<h1 id="heading-1"></h1>
<ol>
<li>AppSpec.yml 파일을 추가한 후, 프로젝트를 코드 저장소인 GitHub 혹은 AWS S3에 업로드한다.</li>
</ol>
<h1 id="heading-2"></h1>
<ol start="2">
<li>CodeDeploy에 프로젝트의 특정 버전을 배포해 달라 요청한다.</li>
</ol>
<h1 id="heading-3"></h1>
<ol start="3">
<li>CodeDeploy는 배포를 진행할 EC2 인스턴스들에 설치되어 있는 CodeDeploy Agent들과 통신하며 Agent들에게 요청받은 버전을 배포해 달라고 요청한다.</li>
</ol>
<h1 id="heading-4"></h1>
<ol start="4">
<li>요청을 받은 CodeDeploy Agent들은 코드 저장소에서 프로젝트 전체를 서버로 내려받는다. 그리고 내려받은 프로젝트에 있는 AppSpec.yml 파일을 읽고 해당 파일에 적힌 절차대로 배포를 진행한다.</li>
</ol>
<h1 id="heading-5"></h1>
<ol start="5">
<li>CodeDeploy Agent를 배포를 진행할 후 성공/ 실패 등 결과를 CodeDeploy에게 전달한다.</li>
</ol>
    </div>
  </label>
</div>

#</p>
</blockquote>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#배포--deploy--1"><strong>배포 ( Deploy )</strong></a></li>
  </ul>

  <ul>
    <li><a href="#무중단-배포"><strong>무중단 배포</strong></a></li>
  </ul>

  <ul>
    <li><a href="#중단배포-ice-breaking-"><strong>중단배포( Ice breaking )</strong></a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#in-place-deployment"><strong>In-Place Deployment</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#blue-green-deployment"><strong>Blue-Green Deployment</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#iam--identity-and-access-management-"><strong>IAM ( Identity and Access Management )</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#정책--policy-"><strong>정책 ( Policy )</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#역할--role-"><strong>역할 ( Role )</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#그룹-사용자"><strong>그룹&amp; 사용자</strong></a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#codedeploy"><strong>CodeDeploy</strong></a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li><a href="#codedeploy-구성요소"><strong>CodeDeploy 구성요소</strong></a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>
</div>
</html>















