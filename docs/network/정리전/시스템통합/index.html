<!DOCTYPE html>
<html lang="en">

<head>
  <script data-ad-client="ca-pub-1022327295984162" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="시스템통합 관리 침입 탐지 시스템(IDS) &ndash; Snort 이용    주된 기능
  탐지(Detection)
  잘못된 패킷을 감지하면 사용자에게 알림(주체적으로 처리하지 X, only 안내)
       탐지 종류 2가지
  (1)오용 탐지	알고 있는 것 탐지
  (2)이상 탐지	모르는 것도 탐지(100% 탐지 X)
  너무 민감하게 처리하면 필요한 정보도 차단하는 실수를 할 수 있음
       설치위치 ( 성능이 달라짐 )">

<meta name="description" content="" /><meta property="og:title" content="" />
<meta property="og:description" content="시스템통합 관리 침입 탐지 시스템(IDS) &ndash; Snort 이용    주된 기능
  탐지(Detection)
  잘못된 패킷을 감지하면 사용자에게 알림(주체적으로 처리하지 X, only 안내)
       탐지 종류 2가지
  (1)오용 탐지	알고 있는 것 탐지
  (2)이상 탐지	모르는 것도 탐지(100% 탐지 X)
  너무 민감하게 처리하면 필요한 정보도 차단하는 실수를 할 수 있음
       설치위치 ( 성능이 달라짐 )" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://mung0001.github.io/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%EC%8B%9C%EC%8A%A4%ED%85%9C%ED%86%B5%ED%95%A9/" />


<title>뭉게뭉게</title>
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.63eb88daa545365405ecdbb21033286a325c60a36cfa6d22d21e7c3bc9286941.css" integrity="sha256-Y&#43;uI2qVFNlQF7NuyEDMoajJcYKNs&#43;m0i0h58O8koaUE=">
<script defer src="/en.search.min.290a46a003f1b2fbf3c93d33bf18fb141391b45f48fafbb977922c0a8d526724.js" integrity="sha256-KQpGoAPxsvvzyT0zvxj7FBORtF9I&#43;vu5d5IsCo1SZyQ="></script>
<!--

-->

  
</head>

<body>
  <div class="background">
  <input type="checkbox" class="hidden" id="menu-control" />
  <main class="container flex" style="max-width:100%;" >
    <aside style="padding: 1.5%; max-width: 90%;" class="book-menu">
      
  
<nav styles="background-color:red; position=none;">
구름이 
<h2 class="book-brand">
  <a href="/"><span>뭉게뭉게</span>
  </a>
</h2>


<img style="padding-left: 3%; padding-right: 1%;"src = "https://github.com/mung0001/source/blob/master/static/Go/Golang.jpg?raw=true" width="90%" height="13%" >
<div style="padding-top: 0.2cm; font-size: 0.9em; font-weight: bolder;">
  <div style ="padding-bottom: 0.3cm;">
    Name : Jengkeun Lee
  </div>
  <div style ="padding-bottom: 0.3cm;">
    Mail : mung0001@naver.com
  </div>
</div>

<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  

  
  




 
  
    




  
  <ul>
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/cloudcomputing/" class="">CloudComputing</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/amazonwebservice/" class="collapsed ">Amazon Web Service</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/awstraining/" class="collapsed ">AWS Training</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/awssaa/" class="collapsed ">AWS SAA 시험정리</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/googlecloudplatform/" class="collapsed ">Google Cloud Platform</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/gcptraining/" class="collapsed ">GCP Training</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/microsoftazure/" class="collapsed ">Microsoft Azure</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/azuretraining/" class="collapsed ">Azure Training</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/openstack/" class="collapsed ">OpenStack</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/openstacktraining/" class="collapsed ">OpenStack Training</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/docker/" class="collapsed ">Docker</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/dockertraining/" class="collapsed ">Docker Training</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/cloudcomputing/%EC%A0%95%EB%A6%AC%EC%A0%84/" class="collapsed ">정리전</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/programing/" class="">Programing</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/programing/python/" class="collapsed ">Python</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/programing/shell/" class="collapsed ">Shell</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/programing/golang/" class="collapsed ">Golang</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/programing/web/" class="collapsed ">Web</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/programing/git/" class="collapsed ">Git</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/network/" class="">Network</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/network/network/" class="collapsed ">Network 기본</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/network/snort/" class="collapsed ">Snort</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/network/mail/" class="collapsed ">Mail</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/" class="collapsed ">정리전</a>
  


    




  
  <ul>
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/gns3/" class="">G N S3</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/nas/" class="">Nas</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%EC%A0%95%EB%A6%AC/" class="">Home</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/3tier/" class="">3 Tier</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/sdn/" class="">S D N</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%E3%84%B4-packet/" class="">ㄴ Packet</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%E3%84%B4-portnumber/" class="">ㄴ Portnumber</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%E3%84%B4%EB%B0%A9%ED%99%94%EB%B2%BD/" class="">ㄴ방화벽</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%EB%B0%A9%ED%99%94%EB%B2%BD/" class="">방화벽</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%EB%B3%B4%EC%95%88/" class="">보안</a>
  

</li>
      
    
      
        <li >

  
  <a href="/docs/network/%EC%A0%95%EB%A6%AC%EC%A0%84/%EC%8B%9C%EC%8A%A4%ED%85%9C%ED%86%B5%ED%95%A9/" class="active">시스템통합</a>
  

</li>
      
    
  </ul>
  



  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/network/sophos/" class="collapsed ">Sophos</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/system/" class="">System</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/system/linux/" class="collapsed ">Linux</a>
  


    






  </li>


      
    
      
        

  <li>
    

  
  <a href="/docs/system/lm/" class="collapsed ">Linux master</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <a href="/docs/database/" class="">Database</a>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/database/sqld/" class="collapsed ">SQLD</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
      
        

  <li class="book-section-flat" >
    

  
  <span>Project</span>
  


    




  
  <ul>
    
      
        

  <li>
    

  
  <a href="/docs/project/mini/" class="collapsed ">M Ini</a>
  


    






  </li>


      
    
  </ul>
  



  </li>


      
    
  </ul>
  



  














  
<ul>
  
  <li>
    <a href="/posts/" >
        Blog
      </a>
  </li>
  
</ul>







</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div style="padding-left: 2.5%;" class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>시스템통합</strong>

  <label for="toc-control">
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
  </label>
</div>


  
    <input type="checkbox" class="hidden" id="toc-control" />
    <aside class="hidden clearfix">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#침입-탐지-시스템ids----snort-이용">침입 탐지 시스템(IDS) &ndash; Snort 이용</a></li>
  </ul>

  <ul>
    <li><a href="#snort-설치"><strong>Snort 설치</strong></a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#snort-rules"><strong>Snort rules</strong></a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#스노트-실습"><strong>스노트 실습</strong></a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>



    </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="시스템통합-관리"><strong>시스템통합 관리</strong></h1>
<h2 id="침입-탐지-시스템ids----snort-이용">침입 탐지 시스템(IDS) &ndash; Snort 이용</h2>
<h1 id="heading"></h1>
<ul>
<li>
<p><strong>주된 기능</strong></p>
<ul>
<li>
<p>탐지(Detection)</p>
</li>
<li>
<p>잘못된 패킷을 감지하면 사용자에게 알림(주체적으로 처리하지 X, only 안내)</p>
</li>
</ul>
</li>
</ul>
<h1 id="heading-1"></h1>
<ul>
<li>
<p><strong>탐지 종류 2가지</strong></p>
<ul>
<li>
<p>(1)오용 탐지	알고 있는 것 탐지</p>
</li>
<li>
<p>(2)이상 탐지	모르는 것도 탐지(100% 탐지 X)</p>
</li>
<li>
<p>너무 민감하게 처리하면 필요한 정보도 차단하는 실수를 할 수 있음</p>
</li>
</ul>
</li>
</ul>
<h1 id="heading-2"></h1>
<ul>
<li>
<p><strong>설치위치 ( 성능이 달라짐 )</strong></p>
<ol>
<li>
<p><strong>패킷이 라우터로 들어오기 전</strong></p>
<ul>
<li>
<p>내부 네트워크로 들어오는 모든 패킷은 IDS를 거침</p>
</li>
<li>
<p>쓸 데 없는 패킷을 많이 훑기 때문에 효율적이지 X</p>
<ul>
<li>(일반적으로 정상적인 패킷이 더 많기 때문)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>라우터 뒤</strong></p>
<ul>
<li>
<p>라우터의 패킷 필터링을 거친 패킷을 검사</p>
</li>
<li>
<p>라우터 전보다는 성능저하 덜 함</p>
</li>
<li>
<p>but, 공격 패킷 탐지는 낮아질 수 있음</p>
</li>
</ul>
</li>
<li>
<p><strong>방화벽 뒤</strong></p>
<ul>
<li>일반적으로 2, 3, 4계층 패킷을 거름(5, 6, 7계층도 거름)</li>
</ul>
</li>
<li>
<p><strong>내부 네트워크</strong></p>
<ul>
<li>
<p>내부의 클라이언트를 신뢰할 수 없어 내부 네트워크 해킹을 감시하려 할 때 설치</p>
</li>
<li>
<p>내부 네트워크에 대한 해킹 피해를 방지하기 위해</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="snort-설치"><strong>Snort 설치</strong></h2>
<h4 id="hahahugoshortcode-s0-hbhb"><div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Snort 설치</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <p><img src="/snort/Snort.png" alt="Snort"></p>
<ol>
<li><strong>의존성 관련 프로그램 설치</strong></li>
</ol>
<h1 id="heading"></h1>
<pre><code>- yum -y install http://download-ib01.fedoraproject.org/pub/epel/7/x86_64/Packages/d/daq-2.0.6-1.el7.x86_64.rpm

- yum -y install gcc gcc-c++ flex bison zlib libpcap pcre libdnet tcpdump
- yum -y install ftp://ftp.pbone.net/mirror/archive.fedoraproject.org/epel/7/x86_64/Packages/l/libnghttp2-1.31.1-1.el7.x86_64.rpm


mkdir /[ doc ]
cd /[ doc ]
</code></pre>
<blockquote>
<blockquote>
<p>wget <a href="http://ftp.psu.ac.th/pub/snort/libdnet-1.12.tgz">http://ftp.psu.ac.th/pub/snort/libdnet-1.12.tgz</a></p>
<blockquote>
<blockquote>
<p>tar zxvf libdnet-1.12.tgz</p>
<blockquote>
<blockquote>
<p>cd libdnet-1.12</p>
<blockquote>
<blockquote>
<p>./configure</p>
<blockquote>
<blockquote>
<p>make</p>
<blockquote>
<blockquote>
<p>make install</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h1 id="heading-1"></h1>
<hr>
<hr>
<ol start="2">
<li><strong>스노트 설치</strong></li>
</ol>
<h1 id="heading-2"></h1>
<ul>
<li>
<p><a href="https://www.snort.org/downloads">Snort 다운로드</a></p>
</li>
<li>
<p>wget <a href="https://www.snort.org/downloads/snort/snort-2.9.16-1.centos7.x86_64.rpm">https://www.snort.org/downloads/snort/snort-2.9.16-1.centos7.x86_64.rpm</a></p>
</li>
<li>
<p>rpm -ivh snort&hellip;.</p>
</li>
</ul>
<h1 id="heading-3"></h1>
<hr>
<hr>
<ol start="3">
<li><strong>스노트 기본 설정</strong>
<ul>
<li>
<p>/etc/snort/snort.conf 파일에서 기존의 룰 제거</p>
<ol>
<li>
<p><strong>253번 줄 맨 앞에 # 추가</strong></p>
<ul>
<li>dynamicdetection directory /usr/local/lib/snort_dynamicrules &ndash;&gt; # dynamicdetection directory /usr/local/lib/snort_dynamicrules</li>
</ul>
</li>
<li>
<p><strong>511번, 512번 줄 맨 앞에 # 추가</strong></p>
<ul>
<li>whitelist $WHITE_LIST_PATH/white_list.rules, \ &ndash;&gt; # whitelist $WHITE_LIST_PATH/white_list.rules, \</li>
<li>blacklist $BLACK_LIST_PATH/black_list.rules &ndash;&gt; # blacklist $BLACK_LIST_PATH/black_list.rules</li>
</ul>
</li>
<li>
<p><strong>548번, 651번 줄까지 맨 앞에 # 추가 or 삭제</strong></p>
<ul>
<li>include &hellip;&hellip; &ndash;&gt; # include</li>
</ul>
</li>
</ol>
</li>
<li>
<p>cd /etc/snort/rules</p>
<ul>
<li>vi local.rules
<ul>
<li>alert icmp any any -&gt; any any ( msg:&ldquo;ICMP Detected&rdquo;; sid:1000001; )</li>
<li>[액션][프로토콜][출발지IP][출발지포트]	[목적지IP][목적지포트]		[옵션]</li>
</ul>
</li>
</ul>
<ol start="4">
<li>
<p><strong>snort 실행</strong></p>
<ul>
<li>snort -c /etc/snort/snort.conf -i ens33</li>
</ul>
</li>
<li>
<p><strong>snort 실행확인</strong></p>
<ul>
<li>
<p>tail -f /var/log/snort/alert</p>
</li>
<li>
<p>*tip : snort.log로 시작하는 파일은 문서 파일이 아닌 실행 파일</p>
</li>
<li>
<p>snort 종료하면 나오는 보고서 형식으로 작성됨</p>
</li>
<li>
<p>snort -r 옵션으로 해당 파일을 볼 수 있음</p>
</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
</ol>

    </div>
  </label>
</div>
</h4>
<h2 id="snort-rules"><strong>Snort rules</strong></h2>
<h1 id="heading-3"></h1>
<h4 id="hahahugoshortcode-s1-hbhb"><div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>Snort rules</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <h1 id="rule"><strong>Rule</strong></h1>
<h1 id="heading"></h1>
<h2 id="rule-형태--ruleheader-tcp-udp-icmp-ip-출발지ip-포트----도착지ip-포트-ruleoption"><strong>Rule 형태</strong> : [RuleHeader] [tcp, udp, icmp, ip] [출발지IP] [포트] [-&gt;, &lt;&gt;] [도착지IP] [포트] [RuleOption]</h2>
<pre><code>- ex)alert icmp any any -&gt; any any ( msg:&quot;ICMP Detected&quot;; sid:1000001; )
</code></pre>
<h2 id="rule-header"><strong>Rule Header</strong></h2>
<h1 id="heading-1"></h1>
<ol>
<li>
<p><strong>Rule Action</strong></p>
<ul>
<li>
<p><strong>alert :</strong> 룰에 일치하는 경우 경고를 발생 시키고 로그로 기록한다.</p>
</li>
<li>
<p><strong>log :</strong> 로그로 기록한다.</p>
</li>
<li>
<p><strong>pass :</strong> 패킷을 무시한다.</p>
</li>
<li>
<p><strong>drop :</strong> 패킷을 차단하고 로그로 남긴다.</p>
</li>
<li>
<p><strong>reject :</strong> 패킷을 차단하고 로그로 남긴다, 그리고 tcp 패킷의 경우 rst 패킷을 응답하고 udp  패킷의 경우 icmp unreachable 패킷으로 응답한다.</p>
</li>
<li>
<p><strong>sdrop :</strong> 패킷을 차단하고 로그를 남기지 않는다.</p>
</li>
</ul>
</li>
</ol>
<h1 id="heading-2"></h1>
<ol start="2">
<li>
<p><strong>프로토콜</strong></p>
<ul>
<li>TCP, UDP, ICMP, IP</li>
</ul>
</li>
</ol>
<h1 id="heading-3"></h1>
<ol start="3">
<li>
<p><strong>IP 주소</strong></p>
<ul>
<li>
<p>any는 모든 IP</p>
</li>
<li>
<p>논리부정연산자(!) 사용 가능</p>
</li>
<li>
<p>여러 IP주소에 대한 표기 [] 사용, 콤마(,)로 구분</p>
<ul>
<li>ex) !192.168.1.0/24   ![192.168.1.0/24,10.1.1.0/24]</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>포트 번호</strong></p>
<ul>
<li>
<p>1:1024 = 1 ~ 1024</p>
</li>
<li>
<p>:1024 = 1024 port 이하</p>
</li>
<li>
<p>1024: = 1024 port 이상</p>
</li>
<li>
<p>!1:1024 = 1 ~ 1024 port를 제외한 나머지</p>
</li>
</ul>
</li>
<li>
<p><strong>패킷 방향</strong></p>
<ul>
<li>-&gt; outgoing 패킷</li>
<li>&lt;- 존재하지 않는다</li>
<li>&lt;&gt; 양방향</li>
</ul>
</li>
</ol>
<h2 id="rule-option"><strong>Rule Option</strong></h2>
<h1 id="heading-4"></h1>
<ul>
<li>
<p>Rule Option은 새미콜론(;)으로 구분한다.</p>
<ul>
<li>
<p><strong>general :</strong> 룰에 대한 정보를 포함하는 옵션</p>
</li>
<li>
<p><strong>msg :</strong> alert 엔진을 통해 전달하는 메시지를 설정할 수 있다.</p>
<ul>
<li>ex) msg:&ldquo;<!-- raw HTML omitted -->&rdquo;;</li>
</ul>
</li>
<li>
<p><strong>sid :</strong> Snort ID의 약자로 룰을 식별하기 위해 사용된다.</p>
<ul>
<li>ex)sid:<!-- raw HTML omitted -->;</li>
</ul>
</li>
<li>
<p><strong>payload :</strong> 패킷 내 페이로드 내부의 데이터를 찾고 상호작용을 할 수 있는 옵션</p>
</li>
<li>
<p><strong>content :</strong> 페이로드 내 존재하는 특정 문자열이나 헥스 값 등을 판별하여 룰에 영향을 줄 수 있다. 사실상 가장 많이 쓰일 것 같다. 헥스 값의 경우 ‘|’ 으로 감싸주어 사용 가능하다.</p>
<ul>
<li>ex)<strong>content :</strong>[!]&ldquo;<!-- raw HTML omitted -->&rdquo;;</li>
</ul>
</li>
<li>
<p><strong>depth :</strong> 지정된 패턴을 검색 시 패킷의 길이를 지정할 수 있다. depth가 5인 경우 페이로드의 처음 5바이트 내에서 지정된 패턴을 찾는다. offset 키워드와 함께 사용 가능하다.</p>
</li>
<li>
<p><strong>offset :</strong> depth와 비슷하며 함께 자주 쓰인다. 말 그대로 해당 오프셋부터 패턴을 검색한다. offset이 5인 경우 offset 5부터 지정된 패턴을 검색한다.</p>
<ul>
<li>ex) alert tcp any any -&gt; any 80 (content:&ldquo;cgi-bin/phf&rdquo;; offset:4; depth:20;)</li>
<li>80(http/tcp)로 접근하는 모든 패킷의 offset 4부터 20바이트 내 cgi-bin/phf 문자열이 존재하는지 확인한다.</li>
</ul>
</li>
<li>
<p><strong>non-payload :</strong> 페이로드가 없는 데이터에서 사용</p>
</li>
<li>
<p><strong>fragoffset :</strong> IP Fragment 오프셋 필드의 값을 비교할 수 있다.</p>
<ul>
<li>ex)fragoffset:[!]&lt;|&gt;]<!-- raw HTML omitted -->;</li>
</ul>
</li>
<li>
<p><strong>ttl :</strong> TTL(Time To Live) 항목이다. traceroute 명령어를 탐지하기 위한 키워드이다.</p>
<ul>
<li>ex)ttl:[&lt;,&gt;,=,&lt;=,&gt;=]<!-- raw HTML omitted -->; , ttl:[<!-- raw HTML omitted -->]-[&lt;number];</li>
</ul>
</li>
<li>
<p><strong>fragbits :</strong> 단편화된 패킷이거나 IP Header 내 flags 필드에 비트가 설정되어 있는지 확인하는데 사용된다.</p>
<ul>
<li>ex)fragbits:MD+; More Fragments bit &amp; Don’t Fragments bit</li>
</ul>
</li>
<li>
<p><strong>flags :</strong> TCP flag 비트를 확인하는데 사용한다. 기본적으로 UAPRSF(URG, ACK, PSH, RST, SYN, FIN)를 확인할 수 있고, 추가적으로 CWR, ECE 를 사용할 수 있다.</p>
<ul>
<li>
<p>ex) alert tcp any any -&gt; any any (flags:SF;) 모든 패킷에 SYN과 FIN 패킷을 탐지한다.</p>
</li>
<li>
<p>탐지 가능한 공격 : X-Mas 스캔, Null 스캔</p>
<ul>
<li>X-Max 스캔</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">alert tcp any any <span style="color:#f92672">-&gt;</span> any any (mag:<span style="color:#e6db74">&#34;X-Max Scan Detected!!&#34;</span>; flags:FPU; sid:<span style="color:#ae81ff">1000004</span>;)
</code></pre></div><pre><code>
 - Null 스캔
 ```python
 alert tcp any any -&gt; any any (mag:&quot;Null Scan Detected!!&quot;; flags:0; sid:1000005;)
</code></pre><pre><code>
   
</code></pre></li>
</ul>
</li>
<li>
<p><strong>threshold 옵션</strong> : 행위기반 탐지가 가능한 옵션</p>
<ul>
<li>track by_src : 동일한 출발지에서</li>
<li>track by_dst : 동일한 목적지로</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">threshold:type threshold, 	limit,  		 both
<span style="color:#75715e">#  				패킷량,   	임계시간 		임계시간 단위당 로그 발생량</span>
</code></pre></div><pre><code>    - count : 수
    - seconds : 초


</code></pre></li>
<li>
<p><strong>seq :</strong> TCP sequence number를 확인한다.</p>
<ul>
<li>ex) seq:0;</li>
</ul>
</li>
<li>
<p><strong>ack :</strong> TCP acknowledge number를 확인한다.</p>
<ul>
<li>ex) ack:0;</li>
</ul>
</li>
<li>
<p><strong>Post-detection :</strong> 사후탐지에 대한 옵션, 룰 실행 후의 규칙</p>
</li>
<li>
<p><strong>react :</strong> 패킷을 차단하거나 경고 메시지를 출력한다.</p>
<ul>
<li><strong>react:block; :</strong> 패킷을 차단한다</li>
</ul>
</li>
<li>
<p><strong>ARP 탐지 추가</strong></p>
<ul>
<li>vi /etc/snort/snort.conf ARP spoot 수정 preprocessor arpspoof_detect_host: [ IP 주소 ] [ MAC 주소 ]</li>
</ul>
</li>
<li>
<p><strong>preprocessos</strong> : snort.conf 파일에 설정하는 전처리 기능</p>
<ul>
<li>
<p>itype : ICMP Type 지정</p>
</li>
<li>
<p>icode : ICMP Type의 Code 지정</p>
</li>
<li>
<p>ICMP Redirect 탐지, ICMP 요청만 탐지</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>

    </div>
  </label>
</div>
</h4>
<hr>
<hr>
<h1 id="heading-4"></h1>
<h2 id="스노트-실습"><strong>스노트 실습</strong></h2>
<h4 id="hahahugoshortcode-s2-hbhb"><div class="book-expand">
  <label>
    <div class="book-expand-head flex justify-between">
      <span>스노트 실습</span>
      <span>...</span>
    </div>
    <input type="checkbox" class="hidden" />
    <div class="book-expand-content markdown-inner">
      <p><img src="/snort/Base.png" alt="Snort_t01"></p>
<h1 id="heading"></h1>
<h2 id="실습-환경-구성"><strong>실습 환경 구성</strong></h2>
<h1 id="heading-1"></h1>
<hr>
<hr>
<h1 id="heading-2"></h1>
<h2 id="스노트-실습"><strong>스노트 실습</strong></h2>
<h1 id="heading-3"></h1>
<p><img src="/snort/Base.png" alt="Snort_t01"></p>
<p><img src="/snort/Snort_t01" alt="S_t"></p>

    </div>
  </label>
</div>
</h4>
<p>~
~</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside style="max-width: 14%;" class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#침입-탐지-시스템ids----snort-이용">침입 탐지 시스템(IDS) &ndash; Snort 이용</a></li>
  </ul>

  <ul>
    <li><a href="#snort-설치"><strong>Snort 설치</strong></a>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#snort-rules"><strong>Snort rules</strong></a></li>
  </ul>

  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#스노트-실습"><strong>스노트 실습</strong></a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>


 
    </aside>
    
  </main>

  
</body>
</div>
</html>















